<!DOCTYPE html>

<html>

<head>

<meta charset="utf-8" />
<meta name="generator" content="pandoc" />
<meta http-equiv="X-UA-Compatible" content="IE=EDGE" />


<meta name="author" content="Andreas Handel" />


<title>A few simple models</title>

<script src="site_libs/jquery-1.11.3/jquery.min.js"></script>
<meta name="viewport" content="width=device-width, initial-scale=1" />
<link href="site_libs/bootstrap-3.3.5/css/spacelab.min.css" rel="stylesheet" />
<script src="site_libs/bootstrap-3.3.5/js/bootstrap.min.js"></script>
<script src="site_libs/bootstrap-3.3.5/shim/html5shiv.min.js"></script>
<script src="site_libs/bootstrap-3.3.5/shim/respond.min.js"></script>
<script src="site_libs/jqueryui-1.11.4/jquery-ui.min.js"></script>
<link href="site_libs/tocify-1.9.1/jquery.tocify.css" rel="stylesheet" />
<script src="site_libs/tocify-1.9.1/jquery.tocify.js"></script>
<script src="site_libs/navigation-1.1/tabsets.js"></script>
<script src="site_libs/accessible-code-block-0.0.1/empty-anchor.js"></script>
<link href="site_libs/font-awesome-5.1.0/css/all.css" rel="stylesheet" />
<link href="site_libs/font-awesome-5.1.0/css/v4-shims.css" rel="stylesheet" />
<link rel="icon" type="image/png" href="media/SMIlogo.png" />




<style type="text/css">
h1 {
  font-size: 34px;
}
h1.title {
  font-size: 38px;
}
h2 {
  font-size: 30px;
}
h3 {
  font-size: 24px;
}
h4 {
  font-size: 18px;
}
h5 {
  font-size: 16px;
}
h6 {
  font-size: 12px;
}
.table th:not([align]) {
  text-align: left;
}
</style>

<link rel="stylesheet" href="SMIstyle.css" type="text/css" />



<style type = "text/css">
.main-container {
  max-width: 940px;
  margin-left: auto;
  margin-right: auto;
}
code {
  color: inherit;
  background-color: rgba(0, 0, 0, 0.04);
}
img {
  max-width:100%;
}
.tabbed-pane {
  padding-top: 12px;
}
.html-widget {
  margin-bottom: 20px;
}
button.code-folding-btn:focus {
  outline: none;
}
summary {
  display: list-item;
}
</style>


<style type="text/css">
/* padding for bootstrap navbar */
body {
  padding-top: 52px;
  padding-bottom: 40px;
}
/* offset scroll position for anchor links (for fixed navbar)  */
.section h1 {
  padding-top: 57px;
  margin-top: -57px;
}
.section h2 {
  padding-top: 57px;
  margin-top: -57px;
}
.section h3 {
  padding-top: 57px;
  margin-top: -57px;
}
.section h4 {
  padding-top: 57px;
  margin-top: -57px;
}
.section h5 {
  padding-top: 57px;
  margin-top: -57px;
}
.section h6 {
  padding-top: 57px;
  margin-top: -57px;
}
.dropdown-submenu {
  position: relative;
}
.dropdown-submenu>.dropdown-menu {
  top: 0;
  left: 100%;
  margin-top: -6px;
  margin-left: -1px;
  border-radius: 0 6px 6px 6px;
}
.dropdown-submenu:hover>.dropdown-menu {
  display: block;
}
.dropdown-submenu>a:after {
  display: block;
  content: " ";
  float: right;
  width: 0;
  height: 0;
  border-color: transparent;
  border-style: solid;
  border-width: 5px 0 5px 5px;
  border-left-color: #cccccc;
  margin-top: 5px;
  margin-right: -10px;
}
.dropdown-submenu:hover>a:after {
  border-left-color: #ffffff;
}
.dropdown-submenu.pull-left {
  float: none;
}
.dropdown-submenu.pull-left>.dropdown-menu {
  left: -100%;
  margin-left: 10px;
  border-radius: 6px 0 6px 6px;
}
</style>

<script>
// manage active state of menu based on current page
$(document).ready(function () {
  // active menu anchor
  href = window.location.pathname
  href = href.substr(href.lastIndexOf('/') + 1)
  if (href === "")
    href = "index.html";
  var menuAnchor = $('a[href="' + href + '"]');

  // mark it active
  menuAnchor.parent().addClass('active');

  // if it's got a parent navbar menu mark it active as well
  menuAnchor.closest('li.dropdown').addClass('active');
});
</script>

<!-- tabsets -->

<style type="text/css">
.tabset-dropdown > .nav-tabs {
  display: inline-table;
  max-height: 500px;
  min-height: 44px;
  overflow-y: auto;
  background: white;
  border: 1px solid #ddd;
  border-radius: 4px;
}

.tabset-dropdown > .nav-tabs > li.active:before {
  content: "";
  font-family: 'Glyphicons Halflings';
  display: inline-block;
  padding: 10px;
  border-right: 1px solid #ddd;
}

.tabset-dropdown > .nav-tabs.nav-tabs-open > li.active:before {
  content: "&#xe258;";
  border: none;
}

.tabset-dropdown > .nav-tabs.nav-tabs-open:before {
  content: "";
  font-family: 'Glyphicons Halflings';
  display: inline-block;
  padding: 10px;
  border-right: 1px solid #ddd;
}

.tabset-dropdown > .nav-tabs > li.active {
  display: block;
}

.tabset-dropdown > .nav-tabs > li > a,
.tabset-dropdown > .nav-tabs > li > a:focus,
.tabset-dropdown > .nav-tabs > li > a:hover {
  border: none;
  display: inline-block;
  border-radius: 4px;
  background-color: transparent;
}

.tabset-dropdown > .nav-tabs.nav-tabs-open > li {
  display: block;
  float: none;
}

.tabset-dropdown > .nav-tabs > li {
  display: none;
}
</style>

<!-- code folding -->



<style type="text/css">

#TOC {
  margin: 25px 0px 20px 0px;
}
@media (max-width: 768px) {
#TOC {
  position: relative;
  width: 100%;
}
}

@media print {
.toc-content {
  /* see https://github.com/w3c/csswg-drafts/issues/4434 */
  float: right;
}
}

.toc-content {
  padding-left: 30px;
  padding-right: 40px;
}

div.main-container {
  max-width: 1200px;
}

div.tocify {
  width: 20%;
  max-width: 260px;
  max-height: 85%;
}

@media (min-width: 768px) and (max-width: 991px) {
  div.tocify {
    width: 25%;
  }
}

@media (max-width: 767px) {
  div.tocify {
    width: 100%;
    max-width: none;
  }
}

.tocify ul, .tocify li {
  line-height: 20px;
}

.tocify-subheader .tocify-item {
  font-size: 0.90em;
}

.tocify .list-group-item {
  border-radius: 0px;
}

.tocify-subheader {
  display: inline;
}
.tocify-subheader .tocify-item {
  font-size: 0.95em;
}

</style>



</head>

<body>


<div class="container-fluid main-container">


<!-- setup 3col/9col grid for toc_float and main content  -->
<div class="row-fluid">
<div class="col-xs-12 col-sm-4 col-md-3">
<div id="TOC" class="tocify">
</div>
</div>

<div class="toc-content col-xs-12 col-sm-8 col-md-9">




<div class="navbar navbar-inverse  navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar">
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <a class="navbar-brand" href="index.html">SMI Course</a>
    </div>
    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
        <li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-expanded="false">
    General Information
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
    <li>
      <a href="./Course_Syllabus.html">Syllabus</a>
    </li>
    <li>
      <a href="./Course_Schedule.html">Schedule</a>
    </li>
  </ul>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-expanded="false">
    Modules
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
    <li class="dropdown-submenu">
      <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-expanded="false">1. Coures and Tools Introduction</a>
      <ul class="dropdown-menu" role="menu">
        <li>
          <a href="./1a_Course_Introduction.html">1a. Course introduction</a>
        </li>
        <li>
          <a href="./1b_R_and_RStudio.html">1b. R and Rstudio</a>
        </li>
        <li>
          <a href="./1c_DSAIRM.html">1c. DSAIRM</a>
        </li>
        <li>
          <a href="./1d_Further_Tools.html">1d. Further Tools</a>
        </li>
      </ul>
    </li>
    <li class="dropdown-submenu">
      <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-expanded="false">2. Introduction to Immunology</a>
      <ul class="dropdown-menu" role="menu">
        <li>
          <a href="./2a_Introduction_to_Immunology.html">2a. Introduction to Immunology</a>
        </li>
      </ul>
    </li>
    <li class="dropdown-submenu">
      <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-expanded="false">3. Introduction to Simulation Modeling</a>
      <ul class="dropdown-menu" role="menu">
        <li>
          <a href="./3a_Introduction_to_Modeling.html">3a. Introduction to Simulation Modeling</a>
        </li>
        <li>
          <a href="./3b_Model_Thinking.html">3b. Model Thinking</a>
        </li>
        <li>
          <a href="./3c_Simple_Models.html">3c. A few simple models</a>
        </li>
        <li>
          <a href="./3d_Model_Types.html">3d. Types of simulation models</a>
        </li>
        <li>
          <a href="./3e_Exercises.html">3e. Exercises</a>
        </li>
      </ul>
    </li>
    <li class="dropdown-submenu">
      <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-expanded="false">4. Viral Infections and Immunology</a>
      <ul class="dropdown-menu" role="menu">
        <li>
          <a href="./4a_Viral_Infections_Immunology.html">4a. Viral Infections and Immunology</a>
        </li>
      </ul>
    </li>
    <li class="dropdown-submenu">
      <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-expanded="false">5. Using Simulation Models</a>
      <ul class="dropdown-menu" role="menu">
        <li>
          <a href="./5a_Uses_of_Simulation_Models.html">5a. Uses of Simulation Models</a>
        </li>
        <li>
          <a href="./5b_Exercises.html">5b. Exercises</a>
        </li>
      </ul>
    </li>
    <li class="dropdown-submenu">
      <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-expanded="false">6. Extracellular Infections and Immunology</a>
      <ul class="dropdown-menu" role="menu">
        <li>
          <a href="./6a_Extracellular_Infections_Immunology.html">6a. Extracellular Infections and Immunology</a>
        </li>
      </ul>
    </li>
    <li class="dropdown-submenu">
      <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-expanded="false">7. What influences model results</a>
      <ul class="dropdown-menu" role="menu">
        <li>
          <a href="./7a_What_influences_model_results.html">7a. What influences model results</a>
        </li>
        <li>
          <a href="./7b_Structural_Uncertainty.html">7b. Structural Uncertainty</a>
        </li>
        <li>
          <a href="./7c_Parameter_Uncertainty.html">7c. Parameter Uncertainty</a>
        </li>
        <li>
          <a href="./7d_Model_Stochasticity.html">7d. Model Stochasticity</a>
        </li>
        <li>
          <a href="./7e_Exercises.html">7e. Exercises</a>
        </li>
      </ul>
    </li>
    <li class="dropdown-submenu">
      <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-expanded="false">8. How to build and assess models</a>
      <ul class="dropdown-menu" role="menu">
        <li>
          <a href="./8a_Model_Building_Assessment.html">8a. Model building and assessment overview</a>
        </li>
        <li>
          <a href="./8b_Building_Models.html">8b. How to build good models</a>
        </li>
        <li>
          <a href="./8c_Assessing_Models.html">8c. Assessing published models</a>
        </li>
      </ul>
    </li>
  </ul>
</li>
<li>
  <a href="./Project_Information.html">Project</a>
</li>
<li>
  <a href="./Course_Communication.html">Communication</a>
</li>
<li>
  <a href="./Course_Glossary.html">Glossary</a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-expanded="false">
    Resources
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
    <li>
      <a href="./Course_Resources.html">Course Resources</a>
    </li>
    <li>
      <a href="./General_Resources.html">General Resources</a>
    </li>
  </ul>
</li>
      </ul>
      <ul class="nav navbar-nav navbar-right">
        <li>
  <a href="https://github.com/andreashandel/SMIcourse">
    <span class="fa fa-github fa-lg"></span>
     
  </a>
</li>
      </ul>
    </div><!--/.nav-collapse -->
  </div><!--/.container -->
</div><!--/.navbar -->

<div class="fluid-row" id="header">



<h1 class="title toc-ignore">A few simple models</h1>
<h4 class="author">Andreas Handel</h4>
<h4 class="date">2020-07-16 16:03:13</h4>

</div>


<div id="overview" class="section level1">
<h1>Overview</h1>
<p>This document provides an introduction to a few basic models that describe within-host infection dynamics.</p>
</div>
<div id="learning-objectives" class="section level1">
<h1>Learning Objectives</h1>
<ul>
<li>Be familiar with a few basic within-host models.</li>
</ul>
</div>
<div id="slides" class="section level1">
<h1>Slides</h1>
<p>We will discuss this topic in one of the zoom sessions. The slides for that session <a href="./slides/Simple_Models_Slides.html">can be found here.</a></p>
</div>
<div id="reading" class="section level1">
<h1>Reading</h1>
<p><em>This material overlaps with the slides.</em></p>
</div>
<div id="a-very-simple-compartmental-model" class="section level1">
<h1>A very simple compartmental model</h1>
<p>Consider a single population of entities (pathogens/immune cells/humans/animals) that grow or die. We want to model this population. We’ll implement the model as a discrete time equation, given by:</p>
<p><span class="math display">\[
P_{t+dt} = P_t + dt ( g P_t - d_P P_t )
\]</span></p>
<p><span class="math inline">\(P_t\)</span> are the number of pathogens in the population at current time <span class="math inline">\(t\)</span>, <span class="math inline">\(dt\)</span> is some time step and <span class="math inline">\(P_{t+dt}\)</span> is the number of pathogens in the future after that time step has been taken. The processes/mechanisms modeled are growth at rate <span class="math inline">\(g\)</span> and death at rate <span class="math inline">\(d_P\)</span>.</p>
<p>Try to “simulate” the model for yourself, either in our head or with pencil or paper. Assume we start with <span class="math inline">\(B_0=100\)</span> bacteria at t=0, go in steps of hours (<span class="math inline">\(dt=1h\)</span>) and birth rate is g=4 per hour and death is d=2 per hour. How many bacteria are there after 1,2,3… hours?</p>
<div id="adding-the-immune-response" class="section level2">
<h2>Adding the immune response</h2>
<p>The model above is the simplest possible model, tracking only a single population. Things get more interesting once there are multiple, interacting components. We can extend our model by including an equation for the immune response. A very simple model for the dynamics of bacteria and the immune response can be formulated as the following 2 differential equation model (Figure @ref(fig:bacteriadiagram) shows the corresponding diagram):</p>
<p><span class="math display">\[
\begin{aligned}
\textrm{Bacteria} \qquad \dot{B} &amp; = gB(1-\frac{B}{B_{max}}) - d_B B - kBI \\
\textrm{Immune Response} \qquad \dot{I} &amp; =  rBI - d_I I     
\end{aligned}
\]</span> In this model, some initial population of bacteria grow at rate <span class="math inline">\(g\)</span>, which saturates as they approach some carrying capacity <span class="math inline">\(B_{max}\)</span>. The bacteria also die at some fixed rate <span class="math inline">\(d_B\)</span> and are additionally cleared by the immune response at rate <span class="math inline">\(k\)</span>. The immune response is modeled in a very abstract way with a single equation. As such it doesn’t represent any specific biological component, but can instead be considered as the “total strength of the response”. The immune response is induced and has a per-capita growth proportional to the presence of bacteria at rate <span class="math inline">\(r\)</span>, and a death/decay rate of <span class="math inline">\(d_I\)</span>. Note that as for the virus model, many alternative formulations are possible and the most appropriate one will depend on the specific system and question one wants to study. The model above is a minimal model useful as a conceptual starting point. The model is a type of predator-prey model, which have been heavily studied in ecology. Here, the bacteria are the prey and the immune response is the predator.</p>
<div class="figure">
<img src="media/bacteriadiagram.png" alt="Schematic for the simple bacteria model. Solid lines indicate in- and out-flows, dashed lines indicate interactions." width="542" />
<p class="caption">
Schematic for the simple bacteria model. Solid lines indicate in- and out-flows, dashed lines indicate interactions.
</p>
</div>
<p>Simulating the dynamics of this model for some parameter choices leads to dynamics as shown in Figure @ref(fig:bacteriamodel)</p>
<div class="figure">
<img src="media/bacteriamodel.png" alt="Dynamics of the simple bacteria model. Note that the oscillations seen in both bacteria load and immune response are rarely observed in actual infections, suggesting that this simple model might not be fully suitable to describe any real infection process." width="2102" />
<p class="caption">
Dynamics of the simple bacteria model. Note that the oscillations seen in both bacteria load and immune response are rarely observed in actual infections, suggesting that this simple model might not be fully suitable to describe any real infection process.
</p>
</div>
<p>Despite the simplicity of this model, one can obtain rather interesting outcomes. You can explore this model further with DSAIRM.</p>
</div>
<div id="simple-viral-infection-model" class="section level2">
<h2>Simple viral infection model</h2>
<p>A simple model that can capture the basic pattern of an acute viral infection is one that does not include the immune response. The model only considers uninfected and infected cells, as well as free virus. Uninfected cells, <span class="math inline">\(U\)</span>, become infected by free virus, <span class="math inline">\(V\)</span>, at rate <span class="math inline">\(b\)</span>. Infected cells, <span class="math inline">\(I\)</span>, produce virus at rate <span class="math inline">\(p\)</span> and die at rate <span class="math inline">\(d_I\)</span>.</p>
<p>Free virus infects cells at rate <span class="math inline">\(b^{&#39;}\)</span>, and is cleared due by the immune response and other mechanisms (e.g. mechanical transport) at rate <span class="math inline">\(d_V\)</span>. The parameter <span class="math inline">\(g\)</span> is there to account for different experimental units (PFU or similar vs number of cells) and make sure all units are consistent (it is always good to check that each term in your model, both on the left and right side, has the same units). For an acute infection, one usually ignores growth and death of uninfected target cells <span class="citation">(<span class="citeproc-not-found" data-reference-id="beauchemin11"><strong>???</strong></span>; Smith, McCullers, and Adler 2011)</span>. This model can be illustrated graphically showing variables/compartments and all possible processes (Figure @ref(fig:virusdiagram) A). Formulated as a set of ordinary differential equations, the model is given by</p>
<p><span class="math display">\[
\begin{aligned}
\textrm{Uninfected Cells} \qquad \dot{U} &amp; = - bUV \\
\textrm{Infected Cells} \qquad \dot{I} &amp; =  bUV - d_I I \\     
\textrm{Virus} \qquad  \dot{V} &amp; =  pI - d_V V -  gb UV 
\end{aligned}
\]</span> The dynamics obtained from such a model is a single acute infection (Figure @ref(fig:virusmodels)A.)</p>
<p>To describe a chronic virus infection, the model needs to include resource replenishment in the form of an influx of uninfected cells. To prevent unlimited growth of uninfected cells in the absence of an infection, natural cell death also needs to be included. One can also include natural death of infected cells, though if this rate of death is small compared to infection-induced death, it could be ignored. With these additional processes in place, the flow chart illustrating the model is shown in Figure @ref(fig:virusdiagram)B, the differential equations for the model are given by <span class="math display">\[
\begin{aligned}
\textrm{Uninfected Cells} \qquad \dot{U} &amp; = n - bUV -mU \\
\textrm{Infected Cells} \qquad \dot{I} &amp; =  bUV - d_I I - mI\\     
\textrm{Virus} \qquad  \dot{V} &amp; =  pI - d_V V -  b^{&#39;} UV
\end{aligned}
\]</span> with <em>n</em> and <em>m</em> representing natural birth/production and death of cells. The dynamics obtained from such a model now allows for a steady state, representing a chronic infection (Figure @ref(fig:virusmodels)B.)</p>
<div class="figure">
<img src="media/virusdiagram.png" alt="Diagram for the simple viral infection models. A) acute infection. B) chronic infection. Parameters are defined and explained in the text." width="852" />
<p class="caption">
Diagram for the simple viral infection models. A) acute infection. B) chronic infection. Parameters are defined and explained in the text.
</p>
</div>
<div class="figure">
<img src="media/virusmodels.png" alt="Dynamics of simple viral infection models. A) acute infection. B) chronic infection." width="80%" />
<p class="caption">
Dynamics of simple viral infection models. A) acute infection. B) chronic infection.
</p>
</div>
</div>
<div id="modeling-the-immune-response" class="section level2">
<h2>Modeling the immune response</h2>
<p>The simple bacteria infection model above included a single equation for the immune response, the virus dynamics model did not include the immune response at all. Obviously, in most infections, the immune response plays an important role and thus will need to be considered. The immune response is very complex, with many different entities (cells, cytokines, etc.) interacting in complicated ways. As such, being able to model the immune response in full detail is not possible. The modeler will have to decide which components are important for a given scenario and question and include those, while still trying to keep the model at a manageable level of complexity (see further comments on that point below). Even including only a few immune response components quickly leads to fairy complex models. We illustrate this by including a few immune response components into the acute virus infection model. Specifically, we will add one equation to model the innate immune response, two equations for B-cells and antibodies, and one equation for CD8 T-cells.</p>
<p>The model works as follows. Uninfected cells, <span class="math inline">\(U\)</span>, become infected by free virus, <span class="math inline">\(V\)</span>, at rate <span class="math inline">\(b\)</span>. Infected cells, <span class="math inline">\(I\)</span>, produce virus at rate <span class="math inline">\(p\)</span> and die at rate <span class="math inline">\(d_I\)</span>. Free virus infects cells at rate <span class="math inline">\(b^{&#39;}\)</span>, is cleared by antibodies at rate <span class="math inline">\(k^{&#39;}_{A}\)</span> or removed due to other mechanisms (e.g. mechanical transport) at rate <span class="math inline">\(d_V\)</span>. Note that <span class="math inline">\(b^{&#39;}\)</span> and <span class="math inline">\(k^{&#39;}_{A}\)</span> differ from parameters <span class="math inline">\(b\)</span> and <span class="math inline">\(k_{A}\)</span> to account for experimental units (PFU for virus and titer for antibody). A (generic/abstract) innate response, <span class="math inline">\(F\)</span>, is assumed to be produced and decays at rates <span class="math inline">\(p_F\)</span> and <span class="math inline">\(d_F\)</span> in the absence of an infection. Presence of virus leads to an increase in the innate response, with growth saturating at a maximum rate <span class="math inline">\(g_F\)</span>. The maximum level the innate response can reach is given by the parameter <span class="math inline">\(F_{\textrm{max}}\)</span>. The action of the innate response is twofold. First, it can directly counteract the virus by, for instance, reducing virus production rate of infected cells. In our model, the strength of production suppression is determined by the parameter <span class="math inline">\(s_F\)</span>. The second action of the innate response is to induce the adaptive response. The dynamics of activated B cells is modeled as increasing in a sigmoidal manner dependent on both the amount of virus (antigen) and innate response present, with a maximum at rate <span class="math inline">\(g_B\)</span>. Again, since we are focusing on the short-term dynamics of the system, B-cell decay is ignored. In the absence of an infection, B-cells are set to an arbitrary level of 1. B-cells produce antibodies at rate <span class="math inline">\(r_A\)</span>. Antibodies decay naturally at rate <span class="math inline">\(d_A\)</span> and bind to and remove free virus at rate <span class="math inline">\(k_A\)</span>. Finally, T-cells are induced proportional to virus/antigen at rate <span class="math inline">\(a\)</span> and then grow exponentially at rate <span class="math inline">\(g_T\)</span>. Those T-cells kill infected cells at rate <span class="math inline">\(k_T\)</span>.</p>
<p><span class="math display">\[
\begin{aligned}
\textrm{Uninfected cells} \qquad \dot{U} &amp; = - bUV \\
\textrm{Infected cells} \qquad \dot{I} &amp; =  bUV - d_I I -k_T T I\\     
\textrm{Virus} \qquad  \dot{V} &amp; =  \frac{p}{1+s_F F}I - d_V V - k^{&#39;}_{A}AV -  b^{&#39;} UV\\ 
\textrm{Innate response} \qquad \dot{F} &amp; = p_F - d_F F +  \frac{V}{V+h_V} g_F (F_{max} - F)  \\
\textrm{B cells} \qquad \dot{B} &amp; =  \frac{F V}{FV+h_F} g_B B  \\
\textrm{Antibodies} \qquad \dot{A} &amp; =   r_A B  - d_A A  - k_{A}AV \\
\textrm{T-cells} \qquad  \dot{T} &amp; = aV + g_T T
\end{aligned}
\]</span></p>
<p>Simulating the dynamics of this model for some parameter choices leads to dynamics as shown in Figure @ref(fig:immunemodel).</p>
<div class="figure">
<img src="media/immunemodel.png" alt="Dynamics of the model with innate and adaptive immunity for one choice of parameters." width="2102" />
<p class="caption">
Dynamics of the model with innate and adaptive immunity for one choice of parameters.
</p>
</div>
<p>Note that different parameter choices lead to different dynamics. Parameters should be chosen based on what is known about the system. Bigger models tend to have more parameters, each of which needs to be specified. For systems that are not too well studied, obtaining reliable parameter estimates can be a challenge.</p>
<p>While the model is still fairly abstract, it is arguably more realistic comapred to the virus infection model without the immune response. The downside is that this model is more complex. The trade-offs of model simplicity versus complexity are further discussed below. Also note that there are many different ways one could map the detailed dynamics of the immune response into a set of equations. The above example is one way of doing it, but by no means the only one. It is up to the modeler, based on their understanding of the biology of the system, to decide how to implement the model. An interesting discussion and evaluation of different models that were used to simulate influenza infections can be found in <span class="citation">(<span class="citeproc-not-found" data-reference-id="dobrovolny13"><strong>???</strong></span>)</span>.</p>
</div>
</div>
<div id="practice" class="section level1">
<h1>Practice</h1>
<p>You can further explore these models using DSAIRM.</p>
</div>
<div id="further-materials" class="section level1">
<h1>Further materials</h1>
<ul>
<li><p>Our recent review <a href="https://handelgroup.uga.edu/publication/2020-handel-natrevimm/">Simulation Modelling for Immunologists</a> discusses those simple models.</p></li>
<li><p>The paper <a href="https://www.nature.com/articles/nri700">Modelling Viral and Immune System Dynamics</a> by Alan Perelson is another nice introduction focusing on virus models and explaining a few different models.<br />
</p></li>
<li><p>The paper <a href="https://www.nature.com/articles/nri1550">The role of models in understanding CD8+ T-cell memory</a> by Antia et al. introduces a few simple models for T-cell dynamics.</p></li>
</ul>
<div id="refs" class="references">
<div id="ref-smith11">
<p>Smith, Amber M, Jonathan A McCullers, and Frederick R Adler. 2011. “Mathematical Model of a Three-Stage Innate Immune Response to a Pneumococcal Lung Infection.” <em>Journal of Theoretical Biology</em> 276 (1): 106–16. <a href="https://doi.org/10.1016/j.jtbi.2011.01.052">https://doi.org/10.1016/j.jtbi.2011.01.052</a>.</p>
</div>
</div>
</div>



</div>
</div>

</div>

<script>

// add bootstrap table styles to pandoc tables
function bootstrapStylePandocTables() {
  $('tr.header').parent('thead').parent('table').addClass('table table-condensed');
}
$(document).ready(function () {
  bootstrapStylePandocTables();
});


</script>

<!-- tabsets -->

<script>
$(document).ready(function () {
  window.buildTabsets("TOC");
});

$(document).ready(function () {
  $('.tabset-dropdown > .nav-tabs > li').click(function () {
    $(this).parent().toggleClass('nav-tabs-open')
  });
});
</script>

<!-- code folding -->

<script>
$(document).ready(function ()  {

    // move toc-ignore selectors from section div to header
    $('div.section.toc-ignore')
        .removeClass('toc-ignore')
        .children('h1,h2,h3,h4,h5').addClass('toc-ignore');

    // establish options
    var options = {
      selectors: "h1,h2,h3",
      theme: "bootstrap3",
      context: '.toc-content',
      hashGenerator: function (text) {
        return text.replace(/[.\\/?&!#<>]/g, '').replace(/\s/g, '_');
      },
      ignoreSelector: ".toc-ignore",
      scrollTo: 0
    };
    options.showAndHide = false;
    options.smoothScroll = true;

    // tocify
    var toc = $("#TOC").tocify(options).data("toc-tocify");
});
</script>

<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    script.src  = "https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML";
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>

</body>
</html>
